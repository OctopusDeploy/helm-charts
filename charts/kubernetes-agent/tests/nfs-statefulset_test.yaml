suite: "persistence"
templates:
- templates/nfs-statefulset.yaml
tests:
- it: "is not created when NFS is disabled"
  set:
    persistence:
      nfs:
        enabled: false
  asserts:
  - hasDocuments:
      count: 0

- it: "should match snapshot"
  asserts:
  - matchSnapshot: {}

- it: sets the emptyDir size to be the value in values
  set:
    persistence:
      nfs:
        size: 100Gi
  asserts:
  - equal:
      path: spec.template.spec.volumes[?(@.name == 'octopus-volume')].emptyDir.sizeLimit
      value: 100Gi