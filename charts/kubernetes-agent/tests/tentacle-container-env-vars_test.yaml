suite: "tentacle configuration"
templates:
- templates/tentacle-deployment.yaml
tests:
- it: "sets the pod polling connection count to the correct value with quoting"
  set:
    agent:
      pollingConnectionCount: 100
  asserts:
  - equal:
      path: spec.template.spec.containers[0].env[?(@.name == 'TentaclePollingConnectionCount')].value
      value: "100"

- it: "doesn't include serverSubscriptionID when not set"
  set:
    agent:
      serverSubscriptionId: ""
  asserts:
    - notContains:
        path: spec.template.spec.containers[0].env
        content:
          name: "ServerSubscriptionId"

- it: "doesn't include certificate when not set"
  set:
    agent:
      certificate: ""
  asserts:
    - notContains:
        path: spec.template.spec.containers[0].env
        content:
          name: "TentacleCertificateBase64"