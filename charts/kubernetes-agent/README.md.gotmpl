## Kubernetes agent

{{ template "chart.badgesSection" . }}![Octopus Deploy Version: 2024.2.6580+](https://img.shields.io/badge/Octopus_Deploy-2024.2.6580%2B-2F93E0?style=flat-square&logo=octopusdeploy&logoColor=%232F93E0&logoSize=auto)

The Kubernetes agent is the recommended way to deploy to Kubernetes clusters using [Octopus Deploy](https://octopus.com).

The helm chart is hosted on [Docker Hub](https://hub.docker.com/r/octopusdeploy/kubernetes-agent), where you can pull it using Helm.

The source code for the chart can be found at [here](./charts/kubernetes-agent).

## Versions

The Kubernetes agent Helm chart follows [Semantic Versioning](https://semver.org/). Generally, version updates can be interpreted as follows:

- *major* - Breaking changes to the chart. This may include adding or removing of resources, breaking changes in the agent application image or breaking changes to the structure of the `values.yaml`.
- *minor* - New non-breaking features. New features or improvements to the agent application or helm chart itself.
- *patch* - Minor non-breaking bug fixes or changes that do not introduce new features.

The `main` branch will reflect the current development version of the chart. This may be the latest released version or if a new version is in development, may be a pre-release version.

| Version   | Branch                                                                                                                               | Readme                                                                                                                  | values.yaml                                                                                                               |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| 2         | [main](https://github.com/OctopusDeploy/helm-charts/tree/main/charts/kubernetes-agent)                                               | This file                                                                                                               | [here](./values.yaml)                                                                                                     |
| 1         | [release/kubernetes-agent/v1](https://github.com/OctopusDeploy/helm-charts/tree/release/kubernetes-agent/v1/charts/kubernetes-agent) | [here](https://github.com/OctopusDeploy/helm-charts/blob/release/kubernetes-agent/v1/charts/kubernetes-agent/README.md) | [here](https://github.com/OctopusDeploy/helm-charts/blob/release/kubernetes-agent/v1/charts/kubernetes-agent/values.yaml) |

### Migrations

Version 2 of the helm chart introduces breaking changes to `values.yaml`; some elements were renamed, while others were moved.

As such, upgrading from V1 to V2 of the helm chart requires user intervention.

This is documented [here](./migrations.md).

## Persistence

By default unless `persistence.storageClassName` has been set this chart will deploy a local NFS storage provisioner.
If using your own Storage Class, please ensure that you are using a ReadWriteMany (RWX) access mode class.

### Custom Persistent Volumes

If you are using an implementation that does not use standard StorageClasses for PersistentVolumeClaim management, such as the
Google Cloud's [Cloud Storage FUSE CSI driver](https://cloud.google.com/kubernetes-engine/docs/how-to/cloud-storage-fuse-csi-driver-setup)
then this chart can be configured to use a custom PV.

As an example, using Cloud Storage FUSE CSI on Google Kubernetes Engine:

```yaml
persistence:
  storageClassName: "gcs-storage"
  customPersistentVolume:
    enabled: true
    csi:
      driver: gcsfuse.csi.storage.gke.io
      volumeHandle: gcs-bucket-name
    mountOptions:
      - implicit-dirs
```


{{ template "chart.maintainersSection" . }}

{{ template "chart.valuesSection" . }}

----------------------------------------------
Autogenerated from chart metadata using [helm-docs](https://github.com/norwoodj/helm-docs)