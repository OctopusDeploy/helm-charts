# kubernetes-agent

![Version: 2.0.0-alpha.3](https://img.shields.io/badge/Version-2.0.0--alpha.3-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 8.1.1948](https://img.shields.io/badge/AppVersion-8.1.1948-informational?style=flat-square) ![Octopus Deploy Version: 2024.2.6580+](https://img.shields.io/badge/Octopus_Deploy-2024.2.6580%2B-2F93E0?style=flat-square&logo=octopusdeploy&logoColor=%232F93E0&logoSize=auto)

A Helm chart for the Octopus Kubernetes Agent

**Homepage:** <https://octopus.com> 
**Documentation:** [https://octopus.com/docs/](https://octopus.com/docs/infrastructure/deployment-targets/kubernetes/kubernetes-agent)

## Maintainers

| Name | Email | Url |
| ---- | ------ | --- |
| Octopus Deploy | <support@octopus.com> | <https://octopus.com> |

## Source Code

* <https://github.com/OctopusDeploy/helm-charts>

## Values

### Agent values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| agent.acceptEula | string | `"N"` | Setting to Y accepts the [Customer Agreement](https://octopus.com/company/legal) |
| agent.bearerToken | string | `""` | A JWT bearer token use to authenticate with the target Octopus Server |
| agent.certificate | string | `""` | A base64-encoded x509 certificate used to setup a trust between the agent and target Octopus Server |
| agent.debug.disableAutoPodCleanup | bool | `false` | Disables automatic pod cleanup |
| agent.enableMetricsCapture | bool | `true` | True if events should be scraped and added to the metrics config map |
| agent.image | object | `{"pullPolicy":"IfNotPresent","repository":"octopusdeploy/kubernetes-agent-tentacle","tag":"8.1.1948"}` | The repository, pullPolicy & tag to use for the agent image |
| agent.logLevel | string | `"Info"` | The log level of the agent. Logs are written to the pod logs as well as to file |
| agent.machinePolicyName | string | `""` | The machine policy to register the agent with |
| agent.metadata | object | `{"annotations":{},"labels":{}}` | Additional metadata to add to the agent pod & container |
| agent.name | string | `""` | The name of the agent |
| agent.pollingConnectionCount | int | `5` | The number of polling TCP connections to open with the target Octopus Server |
| agent.pollingProxy | object | `{"host":"","password":"","port":80,"username":""}` | The host, port, username and password of the proxy server to use for polling connections |
| agent.resources | object | `{"requests":{"cpu":"100m","memory":"150Mi"}}` | The resource limits and requests assigned to the agent container |
| agent.serverApiKey | string | `""` | An Octopus Server API key use to authenticate with the target Octopus Server |
| agent.serverCertificate | string | `""` | The base64-encoded public x509 certificate used by the target Octopus Server. Must be in the PEM/CER format. |
| agent.serverCommsAddress | string | `""` | The polling communication URL of the target Octopus Server |
| agent.serverCommsAddresses | list | `[]` | The polling communication URLs of the target Octopus Servers when running in High Availability (HA) |
| agent.serverSubscriptionId | string | `""` | The subscription ID that is used to by the agent to identify itself with Octopus Server |
| agent.serverUrl | string | `""` | The URL of the target Octopus Server to register this agent with |
| agent.serviceAccount.annotations | object | `{}` | Annotations to add to the autogenerated service account |
| agent.serviceAccount.name | string | Generates a name based on `agent.name` | The name of the service account for the agent pod |
| agent.space | string | `"Default"` | The Space to register the agent in |

### Agent as Deployment Target values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| agent.deploymentTarget.enabled | bool | `false` | Set to register the agent as a Deployment Target using the provided initial values |

### Agent as Deployment Target initial values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| agent.deploymentTarget.initial.defaultNamespace | string | `""` | The default Kubernetes namespace for deployments |
| agent.deploymentTarget.initial.environments | list | `[]` | The deployment target environments to register the agent with |
| agent.deploymentTarget.initial.tags | list | `[]` | The deployment target tags to register the agent with |
| agent.deploymentTarget.initial.tenantTags | list | `[]` | The deployment target tenant tags to register the agent with |
| agent.deploymentTarget.initial.tenantedDeploymentParticipation | string | `"Untenanted"` | Can be `Untenanted`, `TenantedOrUntenanted` or `Tenanted`. |
| agent.deploymentTarget.initial.tenants | list | `[]` | The deployment target tenants to register the agent with |

### Agent as Worker values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| agent.worker.enabled | bool | `false` | Set to register the agent as a Worker using the provided initial values |

### Agent as Worker initial values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| agent.worker.initial.workerPools | list | `[]` | The worker pools to associate with the worker |

### Persistence

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| persistence.nfs.image | object | `{"pullPolicy":"IfNotPresent","repository":"octopusdeploy/nfs-server","tag":"1.0.1"}` | The repository, pullPolicy & tag to use for the NFS server |
| persistence.nfs.metadata | object | `{"annotations":{},"labels":{}}` | Additional metadata to add to the NFS pod & container |
| persistence.nfs.watchdog.enabled | bool | `true` | If enabled, the NFS watchdog will monitor NFS availability and restart Tentacle and Script Pods if the NFS server is unresponsive |
| persistence.nfs.watchdog.image | object | `{"pullPolicy":"IfNotPresent","repository":"octopusdeploy/kubernetes-agent-nfs-watchdog","tag":"0.1.0"}` | The repository, pullPolicy & tag to use for the NFS watchdog |
| persistence.nfs.watchdog.initial_backoff_seconds | string | `""` | The initial backoff time in seconds to retry failed NFS checks @default 0.5 |
| persistence.nfs.watchdog.loop_seconds | string | `""` | The frequency in seconds to check the NFS server @default 5 |
| persistence.nfs.watchdog.timeout_seconds | string | `""` | The total time to retry failed NFS checks before giving up and deleting the pod @default 10 |
| persistence.size | string | `"10Gi"` | The size of the volume to create |
| persistence.storageClassName | string | `""` | if provided, will disable the default persistence configuration and create a PVC with the provided storage class |

### Script pod values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| scriptPods.disruptionBudgetEnabled | bool | `true` | If true, the script pods will be created with a disruption budget to prevent them from being evicted |
| scriptPods.resources | object | `{"requests":{"cpu":"25m","memory":"100Mi"}}` | The resource limits and requests assigned to script pod containers |
| scriptPods.serviceAccount.annotations | object | `{}` | Annotations to add to the service account |
| scriptPods.serviceAccount.clusterRole | object | `[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]},{"nonResourceURLs":["*"],"verbs":["*"]}]` | if defined, overrides the default ClusterRole rules |
| scriptPods.serviceAccount.name | string | `""` | The name of the service account used for executing script pods |
| scriptPods.serviceAccount.targetNamespaces | list | Uses a ClusterRoleBinding to allow the service account to run in any namespace | Specifies that the pod service account should be constrained to target namespaces |

### Other Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| imagePullSecrets | list | `[]` | custom registry pullSecret<br> See https://kubernetes.io/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod These are used for the tentacle and script pods |
| nameOverride | string | `""` | Override the name of the app |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs](https://github.com/norwoodj/helm-docs)